close all; clear all; clc 

out = sim('fault_shunt_test_3_bus_pmu.slx');

fs = 2000; % sampling frequency 
duration = 3; % test duration (s) 
t = 0:1/fs:duration; 

% calculate envelope of bus 3 phase a
[envelope_upper, envelope_lower] = envelope(out.i3_data(:,1));

% plot current at bus 3 phase a
figure 
plot(t, out.i3_data(:,1), 'b-', 'LineWidth', 1);
hold on; 
plot(t, envelope_upper, 'r--', 'LineWidth', 2);
plot(t, envelope_lower, 'r--', 'LineWidth', 2);
grid on;
xlabel('Time (s)');
ylabel('Current (pu)');